{"version":3,"file":"484-a082bee69c59ec33c435.js","mappings":"2LAyFA,UAtE8CA,IAAiC,IAAhC,UAAEC,EAAY,YAAY,EACvE,MAAMC,GAAeC,EAAAA,EAAAA,QAAuB,OACtC,KAAEC,IAASC,EAAAA,EAAAA,MACX,EAACC,EAAU,EAACC,IAAgBC,EAAAA,EAAAA,WAAS,GACrCC,GAAOC,EAAAA,EAAAA,gBAAc,cAuD3B,OA7CAC,EAAAA,EAAAA,WAAU,KAAO,IAAD,IACd,IAAKT,EAAaU,QAAS,OAC3B,MAAMC,EAAOJ,SAAU,QAAN,EAAJA,EAAMK,YAAI,OAAc,QAAd,EAAVC,EAAYC,oBAAY,WAApB,EAAJC,EAA0BC,eACvC,IAAKL,EAAM,OAGX,KAAOX,EAAaU,QAAQO,YAC1BjB,EAAaU,QAAQQ,YAAYlB,EAAaU,QAAQO,YAIxDZ,GAAa,GAEb,MAAMc,EAASC,SAASC,cAAc,UACtCF,EAAOG,IAAM,gCACbH,EAAOI,OAAQ,EACfJ,EAAOK,YAAc,YACrBL,EAAOM,aAAa,OAAQd,GAC5BQ,EAAOM,aAAa,aAAc1B,GAClCoB,EAAOM,aAAa,QAAkB,SAATvB,EAAkB,cAAgB,gBAC/DiB,EAAOM,aAAa,QAAS,WAE7BzB,EAAaU,QAAQgB,YAAYP,IAChC,CAACZ,EAAMR,EAAWG,KAErBO,EAAAA,EAAAA,WAAU,KACR,MAAMkB,EAAWC,IACM,wBAAjBA,EAAMC,QACND,EAAMrB,MAA4B,WAApBqB,EAAMrB,KAAKuB,MAC3BzB,GAAa,IAGjB0B,OAAOC,iBAAiB,UAAWL,GAGnC,MAAMM,EAAQC,WAAW,KACvB7B,GAAa,IACZ,KAEH,MAAO,KACL0B,OAAOI,oBAAoB,UAAWR,GACtCS,aAAaH,KAEd,KAGDI,EAAAA,EAAAA,GAACC,EAAQ,KACNlC,IAAaiC,EAAAA,EAAAA,GAACE,EAAAA,EAAQ,CAACC,OAAO,WAC/BH,EAAAA,EAAAA,GAAAA,MAAAA,CACEI,IAAKzC,EACL0C,MAAOtC,EAAY,CAAEoC,OAAQ,EAAGG,SAAU,SAAUC,WAAY,UAAa,CAAC,MAQtF,MAAMN,GAAQ,wEAEEO,IAAAA,IAAC,MAAEC,GAAO,SAAKA,EAAMC,GAAGC,SAAO,kBAC5BC,IAAAA,IAAC,MAAEH,GAAO,SAAKA,EAAMI,OAAOC,IAAE,kCAE3BC,IAAAA,IAAC,MAAEN,GAAO,SAAKA,EAAMO,QAAM,eACjCC,IAAAA,IAAC,MAAER,GAAO,SAAKA,EAAMS,OAAOC,MAAI,I","sources":["webpack://andy-tech-blog/./src/features/blog/components/Utterances.tsx"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\"\nimport { graphql, useStaticQuery } from \"gatsby\"\nimport styled from \"@emotion/styled\"\nimport { useThemeMode } from \"@/hooks/useThemeMode\"\n\ntype UtterancesQuery = {\n  site: {\n    siteMetadata: {\n      utterancesRepo?: string | null\n    } | null\n  } | null\n}\n\ninterface UtterancesProps {\n  issueTerm?: string\n}\n\nimport { Skeleton } from \"@/ui/Skeleton\"\n\nconst Utterances: React.FC<UtterancesProps> = ({ issueTerm = \"pathname\" }) => {\n  const containerRef = useRef<HTMLDivElement>(null)\n  const { mode } = useThemeMode()\n  const [isLoading, setIsLoading] = useState(true)\n  const data = useStaticQuery<UtterancesQuery>(graphql`\n    query UtterancesRepoQuery {\n      site {\n        siteMetadata {\n          utterancesRepo\n        }\n      }\n    }\n  `)\n\n  useEffect(() => {\n    if (!containerRef.current) return\n    const repo = data?.site?.siteMetadata?.utterancesRepo\n    if (!repo) return\n\n    // Clear existing children\n    while (containerRef.current.firstChild) {\n      containerRef.current.removeChild(containerRef.current.firstChild)\n    }\n\n    // Reset loading state when props change\n    setIsLoading(true)\n\n    const script = document.createElement(\"script\")\n    script.src = \"https://utteranc.es/client.js\"\n    script.async = true\n    script.crossOrigin = \"anonymous\"\n    script.setAttribute(\"repo\", repo)\n    script.setAttribute(\"issue-term\", issueTerm)\n    script.setAttribute(\"theme\", mode === \"dark\" ? \"github-dark\" : \"github-light\")\n    script.setAttribute(\"label\", \"comment\")\n    \n    containerRef.current.appendChild(script)\n  }, [data, issueTerm, mode])\n\n  useEffect(() => {\n    const handler = (event: MessageEvent) => {\n      if (event.origin !== \"https://utteranc.es\") return\n      if (event.data && event.data.type === \"resize\") {\n        setIsLoading(false)\n      }\n    }\n    window.addEventListener(\"message\", handler)\n    \n    // Fallback: Force show comments after 2 seconds if no resize event received\n    const timer = setTimeout(() => {\n      setIsLoading(false)\n    }, 2000)\n\n    return () => {\n      window.removeEventListener(\"message\", handler)\n      clearTimeout(timer)\n    }\n  }, [])\n\n  return (\n    <Comments>\n      {isLoading && <Skeleton height=\"300px\" />}\n      <div \n        ref={containerRef} \n        style={isLoading ? { height: 0, overflow: \"hidden\", visibility: \"hidden\" } : {}} \n      />\n    </Comments>\n  )\n}\n\nexport default Utterances\n\nconst Comments = styled.section`\n  margin: 40px 0 10px;\n  background: ${({ theme }) => theme.bg.surface};\n  border-radius: ${({ theme }) => theme.radius.lg};\n  padding: 20px;\n  border: 1px solid ${({ theme }) => theme.border};\n  box-shadow: ${({ theme }) => theme.shadow.soft};\n`\n"],"names":["_ref","issueTerm","containerRef","useRef","mode","useThemeMode","isLoading","setIsLoading","useState","data","useStaticQuery","useEffect","current","repo","site","_data$site","siteMetadata","_data$site$siteMetada","utterancesRepo","firstChild","removeChild","script","document","createElement","src","async","crossOrigin","setAttribute","appendChild","handler","event","origin","type","window","addEventListener","timer","setTimeout","removeEventListener","clearTimeout","___EmotionJSX","Comments","Skeleton","height","ref","style","overflow","visibility","_ref2","theme","bg","surface","_ref3","radius","lg","_ref4","border","_ref5","shadow","soft"],"sourceRoot":""}